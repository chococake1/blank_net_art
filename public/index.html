<!doctype html>
<head>
    <title> b l a n k </title>
<style>
    body, html {
        margin: 0;
        padding: 0;
        width: 100%;
        height: 100%;
        overflow: hidden;
    }

    #colorSquare {
        width: 100px;
        height: 100px;
        background-color: red;
        position: absolute;
    }
    #canvas {
        border: 1px solid black;
    }
</style>
</head>

<body>
<canvas id="canvas"></canvas>


<div id="colorSquare"></div>

<script type="module">
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');

    // Set canvas width and height
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    // Event listener for click
    canvas.addEventListener('click', pixelSort);

    // Frame counter for color change
    let frameCount = 0;

    function pixelSort(event) {
        // Draw square
        ctx.fillStyle = 'red'; // Color of the square
        ctx.fillRect(100, 100, 50, 50); // Position and size of the square

        // Get pixel data
        const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
        const pixels = imageData.data;

        // Convert pixels to RGBA arrays for sorting
        const pixelArray = [];
        for (let i = 0; i < pixels.length; i += 4) {
            const rgba = [
                pixels[i],     // Red
                pixels[i + 1], // Green
                pixels[i + 2], // Blue
                pixels[i + 3]  // Alpha
            ];
            pixelArray.push(rgba);
        }

        // Sort the pixelArray based on a criterion (e.g., brightness)
        pixelArray.sort((a, b) => {
            // Calculate brightness of each pixel (grayscale value)
            const brightnessA = (a[0] + a[1] + a[2]) / 3;
            const brightnessB = (b[0] + b[1] + b[2]) / 3;
            return brightnessA - brightnessB;
        });

        // Change color every 8 frames
        if (frameCount % 8 === 0) {
            // Change color
            const randomColor = '#' + Math.floor(Math.random() * 16777215).toString(16);
            for (let i = 0; i < pixelArray.length; i++) {
                // Update pixel data with the new color
                pixels[i * 4] = parseInt(randomColor.substr(1, 2), 16);     // Red
                pixels[i * 4 + 1] = parseInt(randomColor.substr(3, 2), 16); // Green
                pixels[i * 4 + 2] = parseInt(randomColor.substr(5, 2), 16); // Blue
                pixels[i * 4 + 3] = 255; // Alpha (fully opaque)
            }
        }

        // Clear canvas
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        // Put modified pixel data back to canvas
        ctx.putImageData(imageData, 0, 0);

        // Increment frame counter
        frameCount++;
    }
</script>
    
</body>


<!-- <script type="module">
    const cnv = document.getElementById (`recursive_squares`)
    cnv.width = cnv.parentNode.scrollWidth
    cnv.height = cnv.width
    
    const ctx = cnv.getContext (`2d`)

    function rand_col () {
        return `hsl(${ Math.random () * 360 }, 100%, 66%)`
    }

    function draw_square (size) {
        const x = (cnv.width - size) / 2
        const y = (cnv.height - size) / 2

        ctx.fillStyle = rand_col ()
        ctx.fillRect (x, y, size, size)
    }

    function draw_squares (start_size) {
        draw_square (start_size)

        if (start_size > 0) {
            draw_squares (start_size - 20)
        }
    }

    draw_squares (cnv.height)

</script> -->
